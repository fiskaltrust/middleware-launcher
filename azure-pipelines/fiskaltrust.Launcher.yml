trigger:
  batch: true
  branches:
    include:
      - main
      - refs/tags/*

variables:
  branch: $(Build.SourceBranch)

stages:
  - template: templates/stages/test.yml
    parameters:
      ${{ if startsWith(variables.branch, 'refs/tags/v')}}:
        config: release
      ${{ else }}:
        config: debug

  - template: templates/stages/build.yml
    parameters:
      projects:
        - fiskaltrust.Launcher
        - fiskaltrust.LauncherUpdater
      ${{ if startsWith(variables.branch, 'refs/tags/v')}}:
        config: release
      ${{ else }}:
        config: debug
